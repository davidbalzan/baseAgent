# baseAgent - Cursor Rules

This file provides guidance to Cursor AI when working with code in this repository.

## Project Overview

**baseAgent** — An agentic application template with a streaming ReAct loop, multi-channel messaging gateway, extensible tool system, and Markdown-based persistent memory. Built as a foundation for personal AI assistant applications.

### Core Subsystems
- **Agent Loop**: Streaming ReAct-style loop (reason → tool calls → observe → repeat) with resumability
- **Multi-Channel Gateway**: Unified adapter interface for WhatsApp, Telegram, Discord, Slack
- **Memory System**: Markdown files (SOUL.md, USER.md, MEMORY.md) + SQLite for structured data
- **Tool System**: Extensible primitives (file I/O, shell, browser, web search, calendar, email)
- **Proactivity Engine**: Heartbeat scheduler, webhooks, background pollers

## Development Methodology

This project uses **Vibe Coding** — a documentation-driven approach:

1. **Read `CURRENT_FOCUS.md` first** - Quick context on active work
2. **Check `docs/PRD.md`** - Full product requirements and phasing
3. **Check phase tasks** - `docs/phases/phaseN/PHASEN_TASKS.md` for detailed checkboxes
4. **Log decisions** - Add ADRs to `docs/DECISIONS.md` for significant choices
5. **Update progress** - Check boxes as tasks complete

### Key Documents
- `CURRENT_FOCUS.md` - **Active work context** for AI handoffs
- `docs/PRD.md` - Product requirements and milestones
- `docs/DECISIONS.md` - Architectural Decision Records

## Monorepo Structure

```
baseAgent/
├── packages/
│   ├── core/               # Agent loop, state management
│   │   └── src/
│   │       ├── loop/       # ReAct loop implementation
│   │       ├── state/      # Session & state persistence
│   │       └── config/     # Configuration loading
│   ├── gateway/            # Channel adapters, message routing
│   │   └── src/
│   │       ├── adapters/   # WhatsApp, Telegram, Discord, Slack
│   │       ├── router/     # Message routing & queuing
│   │       └── types/      # Shared gateway types
│   ├── memory/             # Memory loading, compaction, SQLite
│   │   └── src/
│   │       ├── markdown/   # .md file loading & parsing
│   │       ├── sqlite/     # Structured data persistence
│   │       └── compaction/ # Auto-summarization
│   ├── tools/              # Built-in tool implementations
│   │   └── src/
│   │       ├── primitives/ # file, shell, browser, web, etc.
│   │       ├── registry/   # Tool loading & schema management
│   │       └── sandbox/    # Execution sandboxing
│   └── dashboard/          # Web admin UI (v1.1+)
├── skills/                 # User-installed extensions
├── workspace/              # Agent's working directory (memory files)
├── config/                 # Runtime configuration
└── docs/                   # Documentation & methodology
```

## Tech Stack

> Decisions tracked in `docs/DECISIONS.md` — some still open

**Runtime:** Node.js 22+ / TypeScript (proposed)
**Database:** SQLite (via better-sqlite3 or Drizzle)
**Web Framework:** Hono 4.x
**LLM Provider:** Claude (Anthropic) with multi-provider abstraction
**Infrastructure:** pnpm workspaces monorepo
**Styling (Dashboard):** Tailwind CSS 4.x

## Status Indicators

- Complete
- In Progress
- Not Started
- Critical Priority
- Medium Priority
- Low Priority

## Coding Preferences

- Clean architectures, modular approach structured for AI context efficiency
- Tailwind for styling
- Latest stable versions
- Favor monorepos
- Avoid unnecessary duplications
- Keep consistency across the codebase
- Streaming-first design — every layer supports partial output
- Adapter pattern for I/O (channels, LLM providers, tools)

## Available Prompts

See `.cursor/prompts/` for reusable prompts:
- `start-session.md` - Load project context at session start
- `log-decision.md` - Create an ADR in DECISIONS.md
- `plan-phase.md` - Generate a new phase task document
- `update-focus.md` - Update Current Focus section
- `check-task.md` - Mark tasks as complete
- `phase-status.md` - Show phase progress
