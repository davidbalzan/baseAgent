llm:
  provider: openrouter
  model: google/gemini-3-flash-preview
  apiKey: ${OPENROUTER_API_KEY}
  fallbackModels:
    - provider: openrouter
      model: google/gemini-3-flash-preview
      apiKey: ${OPENROUTER_API_KEY}
  fallbackCooldownMs: 1800000
  fallbackCooldownReasons:
    - quota-window
    - rate-limit
    - auth
  capableModel:
    provider: openrouter
    model: google/gemini-3.1-pro-preview
  capableFallbackModels:
    - provider: openrouter
      model: google/gemini-3-flash-preview
      apiKey: ${OPENROUTER_API_KEY}
  providers:
    anthropic:
      apiKey: ${ANTHROPIC_API_KEY}
      oauthAuthFile: ${ANTHROPIC_OAUTH_AUTH_FILE}
    openai:
      apiKey: ${OPENAI_API_KEY}
      oauthAuthFile: ${OPENAI_OAUTH_AUTH_FILE}
    opencode:
      baseUrl: ${OPENCODE_BASE_URL}
      providerId: openai
      directory: ${OPENCODE_DIRECTORY}
      timeoutMs: 60000
      modelCooldownMs: 1800000
      modelCooldownReasons:
        - quota-window
        - rate-limit
      modelFallbacks:
        - anthropic/claude-opus-4-20250514
        - openai/gpt-5.3-codex
        - openai/gpt-5.2-codex
        - openai/gpt-5-codex
    ollama:
      baseUrl: http://localhost:11434
  stageRouting:
    enabled: true
    escalationConsecutiveErrorIterations: 2
    maxCapableIterations: 2
    maxCapableCostUsd: 0.20
users:
  links:
    - id: "david"
      channels:
        - "telegram:1975268993"
        - "dashboard:web"
channels:
  telegram:
    enabled: true
    token: ${TELEGRAM_BOT_TOKEN}
    allowedUserIds:
      - "1975268993"
      - "478902165"
  discord:
    enabled: false
    token: ${DISCORD_BOT_TOKEN}
agent:
  maxIterations: 35
  timeoutMs: 180000
  costCapUsd: 1
memory:
  compactionThreshold: 40000
  maxTokenBudget: 8000
  toolOutputDecayIterations: 6
  toolOutputDecayThresholdChars: 5000
  conversationHistoryTokenBudget: 40000
heartbeat:
  enabled: false
  intervalMs: 1800000
governance:
  read: auto-allow
  write: auto-allow
  exec: auto-allow
  toolOverrides:
    add_mcp_server: auto-allow
reflection:
  enabled: true
  preActionChecks: true
  postActionChecks: true
  maxNudgesPerIteration: 1
  sessionSummary: true
  persistToUserMemory: false
  finishGate: true
rateLimit:
  channel:
    maxRequests: 10
    windowMs: 60000
  http:
    maxRequests: 20
    windowMs: 60000
  tool:
    maxRequests: 50
    windowMs: 60000
server:
  port: 3000
  host: 0.0.0.0
mcp:
  servers:
    - name: chrome-devtools
      command: npx
      args:
        - -y
        - chrome-devtools-mcp@latest
        - --no-usage-statistics
      permission: read
      group: browser
    - name: context7
      command: npx
      args:
        - -y
        - "@upstash/context7-mcp@latest"
      permission: read
